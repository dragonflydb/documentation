# Agent Guidelines for Dragonfly Documentation

This document provides instructions for AI agents contributing technical content to the Dragonfly documentation repository.

## About Dragonfly

Dragonfly is a modern in-memory datastore that is fully compatible with Redis and Memcached APIs. It implements novel algorithms and data structures on top of a multi-threaded, shared-nothing architecture, achieving up to 25X performance compared to Redis while supporting millions of QPS on a single instance.

## Repository Structure

This is a [Docusaurus v2](https://docusaurus.io/) documentation site with the following structure:

```
/home/runner/work/documentation/documentation/
├── docs/                          # Main documentation content
│   ├── about/                     # About Dragonfly, FAQ, license
│   ├── getting-started/           # Installation and setup guides
│   ├── command-reference/         # Redis-compatible command documentation
│   ├── managing-dragonfly/        # Configuration, monitoring, operations
│   ├── development/               # Developer resources (CLI, SDKs)
│   ├── integrations/              # Third-party integrations
│   ├── migrating-to-dragonfly/    # Migration guides
│   ├── cloud/                     # Dragonfly Cloud documentation
│   └── reference/                 # Additional reference materials
├── src/                           # React components and pages
├── static/                        # Static assets (images, etc.)
├── docusaurus.config.js           # Docusaurus configuration
├── sidebars.js                    # Sidebar configuration (autogenerated)
└── package.json                   # Build scripts and dependencies
```

## Documentation Standards

### File Format and Front Matter

All documentation files are Markdown (`.md`) with YAML front matter:

```markdown
---
title: Page Title (optional, defaults to H1)
description: SEO description (optional but recommended)
sidebar_position: 1 (optional, controls ordering)
---

# Page Title

Content goes here...
```

### Writing Style

1. **Clear and Concise**: Write in a clear, technical style suitable for developers
2. **Code Examples**: Include practical code examples and command-line snippets
3. **Structure**: Use proper heading hierarchy (H1 for title, H2 for sections, H3 for subsections)
4. **Compatibility Focus**: Emphasize Redis compatibility and migration paths
5. **Performance**: Highlight performance benefits when relevant

### Common Patterns

**Command Reference Format:**
```markdown
---
description: Learn how to use Redis COMMAND command...
---

import PageTitle from '@site/src/components/PageTitle';

# COMMAND NAME

<PageTitle title="Redis COMMAND NAME (Documentation) | Dragonfly" />

## Syntax

    COMMAND argument [optional]

**Time complexity:** O(...)

**ACL categories:** @category1, @category2

Description of the command...

## Return

[Simple string reply](link): Description of return value.

## Examples

```shell
dragonfly> COMMAND arg
"result"
```
```

**Integration Format:**
```markdown
---
sidebar_position: 1
description: Integration Name
---

# Integration Name

## Introduction

Brief introduction to the integration and its purpose...

## TL;DR

Quick start instructions or key points...

## Running [Integration] with Dragonfly

Detailed setup and configuration instructions...
```

### Category Files

Directories use `_category_.yml` files to control sidebar ordering and labels:

```yaml
position: 2
label: "Section Name"
```

## Building and Testing

### Prerequisites

- Node.js >= 16.14
- Yarn package manager

### Commands

```bash
# Install dependencies
yarn

# Start local development server (with live reload)
yarn start

# Build static site
yarn build

# Serve built site locally
yarn serve

# Clear cache
yarn clear
```

### Verification Steps

1. **Build Test**: Always run `yarn build` to ensure no broken links or syntax errors
2. **Local Preview**: Use `yarn start` to preview changes in a browser
3. **Link Checking**: The repository has automated link checking via GitHub Actions
4. **No Broken Markdown**: Docusaurus configuration sets `onBrokenMarkdownLinks: "warn"`

## Content Areas

### 1. Command Reference (`docs/command-reference/`)

Documents Redis-compatible commands supported by Dragonfly. Organized by command category:
- Server Management
- String Operations
- Sorted Sets
- Sets
- Hashes
- Lists
- Geospatial Indices
- Pub/Sub
- Transactions
- etc.

**When adding command docs:**
- Follow the command reference format above
- Include time complexity
- Document all parameters and return values
- Provide practical examples using `dragonfly>` prompt
- Link to related commands

### 2. Integration Guides (`docs/integrations/`)

Documents third-party tools and frameworks that work with Dragonfly:
- Node.js libraries (BullMQ, etc.)
- Python frameworks (Django, Feast, etc.)
- Ruby gems (Sidekiq)
- Database integrations (ClickHouse)
- Distributed patterns (Redlock, Relay)

**When adding integration docs:**
- Explain what the integration is and its purpose
- Provide TL;DR section for quick setup
- Detail configuration changes needed (usually minimal due to Redis compatibility)
- Include code examples and best practices
- Mention performance considerations
- Test the integration if possible

### 3. Managing Dragonfly (`docs/managing-dragonfly/`)

Operational guides covering:
- Configuration flags
- Monitoring and metrics
- High availability and replication
- Backup strategies (AOF, Snapshotting)
- Cluster mode
- Security (ACL, TLS)
- Advanced features (Tiering, Scripting)

**When adding operational docs:**
- Focus on production readiness
- Include configuration examples
- Document best practices
- Explain trade-offs and limitations

### 4. Getting Started (`docs/getting-started/`)

Installation and deployment guides:
- Docker and Docker Compose
- Kubernetes (Operator and Helm)
- Binary installation
- Cloud deployment
- Benchmarking

**When adding getting-started docs:**
- Provide step-by-step instructions
- Include prerequisites
- Show expected output
- Link to next steps

### 5. Migration Guides (`docs/migrating-to-dragonfly/`)

Help users migrate from Redis:
- From single Redis instance
- From Redis Cluster
- General migration strategies

**When adding migration docs:**
- Address common concerns and pain points
- Provide migration checklists
- Document compatibility differences
- Include rollback procedures if applicable

## Technical Conventions

### Code Blocks

Use language-specific syntax highlighting:

````markdown
```bash
docker run -p 6379:6379 docker.dragonflydb.io/dragonflydb/dragonfly
```

```python
import redis
client = redis.Redis(host='localhost', port=6379)
```

```javascript
const Redis = require('ioredis');
const client = new Redis();
```
````

### Command Line Examples

Use the `dragonfly>` prompt for interactive examples:

```markdown
```shell
dragonfly> SET key value
"OK"
dragonfly> GET key
"value"
```
```

### Links

- **Internal links**: Use relative paths like `./other-page.md` or `../category/page.md`
- **External links**: Use full URLs
- **Command references**: Link to related commands when relevant
- **Redis docs**: Link to official Redis documentation for context when helpful

### Images

- Store images in `/static/img/`
- Reference with `/img/filename.png` (not relative paths)
- Include descriptive alt text
- Optimize images for web (reasonable file sizes)

## Key Technical Details

### Dragonfly-Specific Features

When documenting Dragonfly features, highlight these key differentiators:
- **Multi-threaded architecture**: Vertical scaling capabilities
- **Shared-nothing design**: Efficient resource utilization
- **Snapshot consistency**: No fork-based snapshots (unlike Redis)
- **Native pipelining**: Automatic operation batching
- **Cache mode**: Built-in eviction policies
- **Cluster mode**: Both native and emulated modes
- **Lua scripting**: Version 5.4 with special flags
- **HTTP interface**: Admin console support

### Configuration

- Flags can be set via CLI args, flagfile, env vars (DFLY_ prefix), or runtime CONFIG SET
- Use `dragonfly --helpfull` to list all flags
- Default port: 6379 (same as Redis)
- Default databases: 16

### Compatibility

- **High Redis compatibility**: Most Redis commands work without changes
- **Memcached API support**: Dual protocol support
- **Client libraries**: Use standard Redis clients
- **Cluster mode**: Supports Redis cluster protocol (emulated or native)
- **Lua version**: 5.4 (Redis uses 5.1)

### Performance Considerations

- Emphasize vertical scaling vs. Redis clustering
- Mention hardware requirements: x86_64 or arm64, Linux 4.14+ (5.10+ recommended)
- Highlight 25X performance improvement over Redis
- Note multi-threaded advantage for high-throughput workloads

## Git Workflow

**Do not directly commit or push**. Use the provided tools:
- Make changes to documentation files
- Test locally with `yarn build` and `yarn start`
- Changes will be committed and pushed via the appropriate reporting mechanism

## Common Tasks

### Adding a New Integration Guide

1. Create `/docs/integrations/integration-name.md`
2. Follow the integration format template
3. Add entry to `/docs/integrations/integrations.md` overview
4. Test the integration if possible
5. Build and verify: `yarn build`

### Adding a New Command Reference

1. Create `/docs/command-reference/category/command-name.md`
2. Follow the command reference format
3. Include syntax, complexity, ACL categories
4. Provide examples with `dragonfly>` prompt
5. Build and verify: `yarn build`

### Updating Configuration Documentation

1. Edit `/docs/managing-dragonfly/flags.md`
2. Maintain consistent format for each flag
3. Include default values and data types
4. Explain when to use each flag
5. Build and verify: `yarn build`

## Resources

- **Docusaurus Docs**: https://docusaurus.io/docs
- **Dragonfly GitHub**: https://github.com/dragonflydb/dragonfly
- **Dragonfly Website**: https://www.dragonflydb.io
- **Redis Command Reference**: https://redis.io/commands (for compatibility context)
- **Community Discord**: https://discord.gg/HsPjXGVH85

## Quality Checklist

Before finalizing documentation:

- [ ] Front matter is properly formatted with description
- [ ] Headings use proper hierarchy (H1 → H2 → H3)
- [ ] Code examples are tested and work correctly
- [ ] Links are valid (internal and external)
- [ ] Images have alt text and are optimized
- [ ] Content is technically accurate
- [ ] Writing is clear, concise, and free of typos
- [ ] Examples use `dragonfly>` prompt (not `redis>`)
- [ ] Build succeeds: `yarn build`
- [ ] Local preview looks correct: `yarn start`
- [ ] Integration/feature has been tested if applicable

## Notes for AI Agents

- **Minimal changes**: Only modify files directly related to your task
- **Existing structure**: Follow established patterns and conventions
- **Testing required**: Always build and verify changes
- **Redis compatibility**: Emphasize that Dragonfly is a drop-in Redis replacement
- **Performance focus**: Highlight performance benefits when relevant
- **Documentation style**: Match the technical, developer-focused tone
- **No placeholder content**: All examples should be real and tested
- **Version info**: Current stable release info available at https://version.dragonflydb.io/v1
